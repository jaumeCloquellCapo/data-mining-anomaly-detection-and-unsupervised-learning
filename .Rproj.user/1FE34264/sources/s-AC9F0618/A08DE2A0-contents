---
title: "Cancer"
output: html_document
---


```{r setup, include=FALSE}
library(grid) 
library(gridExtra)
library(tidyverse)
library(dummies)
library(readxl)
library(knitr)
library(ggplot2)
library(lubridate)
library(arules)
library(arulesViz)
library(plyr)
library(corrplot)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

```{r}
cancer.dataset <- read.csv(url("https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer/breast-cancer.data"), header=FALSE, col.names = c("class","age","menopause","tumor-size","inv-nodes", "node-caps", "deg-malig", "breast", "breast-quad", "irradiat"))
str(cancer.dataset)
```


1. Edad: edad (en años en el último cumpleaños) del paciente.
en el momento del diagnóstico;
2. Menopausia: si el paciente es pre o posmenopáusica en el momento del diagnóstico;
3. Tamaño del tumor: el mayor diámetro (en mm) del tumor extirpado;
4. Inv-nodos: el número (rango 0 - 39) de ganglios linfáticos axilares que contienen cáncer de mama metastásico visible en el examen histológico;
5. Cápsulas de los nodos: si el cáncer se metastatiza en un ganglio linfático, aunque fuera del sitio original del tumor, puede permanecer "contenido" por la cápsula del ganglio linfático. Sin embargo, con el tiempo y con una enfermedad más agresiva, el tumor puede reemplazar el ganglio linfático y luego penetrar en la cápsula, lo que le permite invadir los tejidos circundantes;
6. Grado de malignidad: el grado histológico (rango 1-3) del tumor. Los tumores que son de grado 1 consisten predominantemente en células que, aunque son neoplásicas, conservan muchas de sus características habituales. Los tumores de grado 3 consisten predominantemente de células
que son altamente anormales;
7. Seno: el cáncer de seno puede ocurrir obviamente en cualquiera de los senos;
8. Cuadrante de mama: la mama se puede dividir en cuatro cuadrantes, utilizando el pezón como un punto central;
9. Irradiación: la radioterapia es un tratamiento que utiliza rayos X de alta energía para destruir las células cancerosas

```{r}
cancer.dataset$deg.malig <- as.factor(cancer.dataset$deg.malig)
```


```{r}
cancer.transactions <- as(cancer.dataset,"transactions") 
itemFrequencyPlot(cancer.transactions, support=0.1, cex.names=0.8)
```



```{r, results='hide'}
car.rules <- apriori(cancer.transactions, parameter=list(support=0.1,target="frequent"))
car.rules.sorted <- sort(car.rules, by="support")
barplot(table(size(car.rules)), xlab="itemset size", ylab="count")
inspect(head(car.rules))
```

```{r, results='hide'}
car.rules <- apriori(cancer.transactions, parameter = list(minlen=2, supp=0.1, conf=0.80))
car.rules.sorted <- sort(car.rules, by="support")
inspect(head(car.rules.sorted))
```

```{r, results='hide'}
car.rules <- apriori(cancer.transactions, parameter = list(minlen=3, supp=0.09, conf=0.75))
car.rules.sorted <- sort(car.rules, by="support")
inspect(car.rules.sorted)
plot(car.rules)
plot(car.rules, method="graph", control=list(type="items"), measure='support', shading='confidence')
 plot(car.rules, method="paracoord", reorder=TRUE)
plot(car.rules, method="grouped")
```

